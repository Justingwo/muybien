<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Muybien - Enjoy your life</title>
    <style>
        /* Web 2.0 Glossy & Skeuomorphic Base */
        body {
            background: #d1d9e1 url('https://www.transparenttextures.com/patterns/light-gray.png');
            font-family: "Segoe UI", "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            line-height: 1.5;
            scroll-behavior: smooth; /* å¹³æ»‘æ»šåŠ¨ */
        }

        /* å…¨å±€å¹³æ»‘è¿‡æ¸¡ */
        * { transition: all 0.25s ease-out; }

        header {
            background: linear-gradient(to bottom, #4c4c4c 0%, #111111 100%);
            height: 50px;
            color: white;
            display: flex;
            align-items: center;
            padding: 0 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            font-size: 15px;
            position: relative;
            z-index: 10;
        }

        .logo {
            font-size: 26px;
            font-weight: 900;
            color: #fff;
            text-transform: lowercase;
            letter-spacing: -1px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
            cursor: pointer;
            font-style: italic;
        }
        .logo:hover { text-shadow: 0 0 15px #fff; transform: scale(1.05); }

        /* --- Search Area --- */
        .search-area {
            text-align: center;
            /* å¢åŠ äº† padding-top ç¡®ä¿ Tab æ ‡ç­¾ä¸ä¼šæŒ¡ä½ Header */
            padding: 60px 0 30px; 
            background: rgba(255,255,255,0.4);
            border-bottom: 1px solid #bbb;
        }

        .search-tabs {
            display: inline-flex;
            gap: 8px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            top: 0;
            z-index: 3;
        }

        .tab {
            display: inline-block;
            padding: 10px 20px;
            background: #e1e1e1;
            border: 1px solid #bbb;
            border-bottom: none;
            border-radius: 20px 20px 0 0;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 0;
        }
        .tab:hover { background: #f9f9f9; transform: translateY(-3px); }
        .tab.active { background: #fff; border-top: 4px solid #4285f4; padding-top: 12px; margin-top: -4px; }

        .search-box-container {
            display: inline-block;
            background: white;
            padding: 10px 8px 8px;
            border-radius: 40px;
            border: 1px solid #bbb;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
            min-width: 520px;
        }
        .search-box-container:hover { box-shadow: 0 6px 20px rgba(66, 133, 244, 0.2); border-color: #4285f4; }

        .search-wrapper {
            display: flex;
            align-items: center;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
            border-radius: 35px;
            background: #fff;
        }

        .search-input {
            width: 500px;
            border: none;
            outline: none;
            padding: 12px 20px;
            font-size: 18px;
            background: transparent;
        }

        .search-btn {
            background: linear-gradient(to bottom, #4285f4, #357ae8);
            color: white;
            border: 1px solid #2f5bb7;
            padding: 10px 30px;
            border-radius: 30px;
            margin: 3px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
        }

        /* --- New Navigation Bar Style --- */
        .quick-nav-container {
            max-width: 1400px;
            /* ç§»é™¤äº†è´Ÿè¾¹è·ï¼Œæ”¹ä¸ºå‘ä¸‹é—´è· 25px */
            margin: 25px auto 25px; 
            padding: 0 20px;
        }
        .quick-nav-bar {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            border: 1px solid #ccc;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            padding: 12px 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .quick-nav-bar:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        .nav-item {
            text-decoration: none;
            color: #444;
            font-weight: bold;
            font-size: 15px;
            padding: 10px 25px;
            background: linear-gradient(to bottom, #fcfcfc 0%, #e8e8e8 100%);
            border: 1px solid #ccc;
            border-radius: 25px;
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-item:hover {
            background: linear-gradient(to bottom, #4285f4 0%, #357ae8 100%);
            color: white;
            border-color: #2f5bb7;
            transform: scale(1.05);
        }
        .nav-icon {
            width: 20px;
            height: 20px;
            color: #a0a9b5;
            margin-right: 8px;
        }
        .nav-item:hover .nav-icon {
            color: white;
        }

        /* --- Layout --- */
        .container {
            max-width: 1400px;
            margin: 20px auto;
            display: grid;
            grid-template-columns: 240px 1fr 240px;
            gap: 25px;
            padding: 0 20px;
        }

        .card, .weather-card, .ad-box {
            background: rgba(255,255,255,0.9);
            border-radius: 12px;
            border: 1px solid #ccc;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            overflow: hidden;
        }
        .card:hover, .weather-card:hover, .ad-box:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border-color: #999;
        }

        .card-header {
            background: linear-gradient(to bottom, #fcfcfc, #e8e8e8);
            padding: 12px 20px;
            font-weight: bold;
            font-size: 16px;
            border-bottom: 1px solid #ccc;
            color: #222;
        }

        .link-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 20px;
            gap: 12px 15px;
        }

        .site-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: #3366cc;
            font-size: 15px;
            padding: 8px 12px;
            border-radius: 8px;
        }
        .site-link:hover {
            background: #f0f4ff;
            text-decoration: underline;
            padding-left: 18px;
            color: #000;
        }

        .site-link img { 
            width: 24px;
            height: 24px; 
            margin-right: 12px;
            border-radius: 4px;
        }

        .weather-card {
            background: linear-gradient(135deg, #1e90ff, #00bfff);
            color: white;
            padding: 25px 15px;
            text-align: center;
            border: none;
            position: relative;
            overflow: hidden;
        }
        .weather-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        .weather-card-content {
            position: relative;
            z-index: 2;
        }

        /* --- å¤©æ°”æ•ˆæœæ ·å¼ --- */
        /* æ™´å¤©æ•ˆæœ */
        .weather-card.weather-clear::before {
            background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.3) 0%, transparent 50%),
                        radial-gradient(circle at 30% 20%, rgba(255,200,0,0.1) 0%, transparent 70%);
        }
        .weather-sun {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #FFD700, #FFA500);
            border-radius: 50%;
            top: -10px;
            right: -10px;
            box-shadow: 0 0 30px rgba(255,200,0,0.6);
            z-index: 1;
        }

        /* å¤šäº‘æ•ˆæœ */
        .weather-cloud {
            position: absolute;
            background: rgba(255,255,255,0.7);
            border-radius: 100px;
            opacity: 0.8;
            z-index: 1;
        }
        .weather-cloud-1 {
            width: 60px;
            height: 25px;
            top: 5px;
            left: 10px;
            animation: float 6s ease-in-out infinite;
        }
        .weather-cloud-2 {
            width: 45px;
            height: 20px;
            top: 35px;
            right: 15px;
            animation: float 8s ease-in-out infinite 1s;
        }
        @keyframes float {
            0%, 100% { transform: translateX(0px); }
            50% { transform: translateX(10px); }
        }

        /* ä¸‹é›¨æ•ˆæœ */
        .weather-rain {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
        }
        .raindrop {
            position: absolute;
            width: 2px;
            height: 10px;
            background: rgba(255,255,255,0.7);
            border-radius: 1px;
            animation: rain-fall 0.6s linear infinite;
        }
        @keyframes rain-fall {
            0% {
                transform: translateY(-10px);
                opacity: 1;
            }
            100% {
                transform: translateY(80px);
                opacity: 0;
            }
        }

        /* ä¸‹é›ªæ•ˆæœ */
        .snowflake {
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(255,255,255,0.8);
            animation: snowfall 3s linear infinite;
        }
        @keyframes snowfall {
            0% {
                transform: translateY(-10px) translateX(0px);
                opacity: 1;
            }
            100% {
                transform: translateY(100px) translateX(20px);
                opacity: 0;
            }
        }

        /* é›¾æ•ˆæœ */
        .weather-card.weather-fog::before {
            background: repeating-linear-gradient(
                90deg,
                rgba(255,255,255,0.1),
                rgba(255,255,255,0.1) 2px,
                transparent 2px,
                transparent 4px
            );
            animation: fog-move 2s linear infinite;
        }
        @keyframes fog-move {
            0% { transform: translateX(0); }
            100% { transform: translateX(4px); }
        }

        /* é›·æš´æ•ˆæœ */
        .weather-lightning {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
            background: none;
        }
        .lightning-flash {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.8);
            opacity: 0;
            animation: lightning-strike 0.3s ease-in-out;
        }
        @keyframes lightning-strike {
            0%, 100% { opacity: 0; }
            50% { opacity: 0.8; }
        }
        .temp { font-size: 42px; font-weight: bold; margin: 10px 0; }

        footer { text-align: center; padding: 50px; font-size: 14px; color: #777; border-top: 1px solid #ccc; }

        #snakeGame:focus { outline: none; }
        .header-icon {
            width: 20px;
            height: 20px;
            color: #a0a9b5;
            margin-right: 8px;
            display: inline-block;
            vertical-align: middle;
        }

        /* portrait for quote */
        .portrait-wrap {
            width: 100%;
            aspect-ratio: 1 / 1; /* square: height equals width */
            border-radius: 8px; /* square with slightly rounded corners */
            overflow: hidden;
            background: #dcdfe3;
            position: relative;
            margin: 0 0 10px;
        }
        .portrait-wrap img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            filter: grayscale(100%) contrast(95%) saturate(80%);
        }
        .portrait-wrap::after {
            content: "";
            position: absolute;
            inset: 0;
            /* coarse grain overlay using inline SVG noise */
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'><filter id='g'><feTurbulence baseFrequency='0.9' numOctaves='1' stitchTiles='stitch'/></filter><rect width='100%' height='100%' filter='url(%23g)' opacity='0.12' /></svg>");
            mix-blend-mode: overlay;
            pointer-events: none;
        }

        /* quote content width and square portrait */
        .quote-content {
            max-width: 420px; /* content line width â€” change value if you want wider/narrower quotes */
            margin: 0 auto;
            text-align: center;
        }

        /* sticky nav styles */
        .quick-nav-container.sticky {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            max-width: none;
            margin: 0;
            padding: 0 20px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 999;
        }

        body.nav-sticky {
            padding-top: 70px; /* offset for fixed nav */
        }

        .site-link {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", sans-serif;
            font-weight: 500;
            letter-spacing: -0.3px;
        }

        /* Games grid & modal */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            padding: 12px;
        }
        .game-tile {
            background: transparent;          /* hide button edge */
            border: none;                     /* hide border/edge */
            border-radius: 10px;
            aspect-ratio: 1 / 1;              /* force square */
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0;
            user-select: none;
        }
        .game-tile:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(34,60,80,0.06); }

        /* hide any inline SVGs and use colored img icons instead */
        .game-tile svg { display: none !important; }
        .game-tile img { width: 64px; height: 64px; object-fit: contain; display: block; border-radius: 8px; }

        /* modal overlay */
        .game-modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.55);
            z-index: 1200;
            align-items: center;
            justify-content: center;
        }
        .game-modal {
            width: 780px;
            height: 520px;
            max-width: 92vw;
            max-height: 88vh;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.35);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .game-modal .modal-header {
            display:flex; align-items:center; justify-content:space-between;
            padding:8px 12px; border-bottom:1px solid #eee; background:#fafafa;
        }
        .game-modal .modal-title { font-weight:700; font-size:14px; color:#222; }
        .game-modal .close-btn {
            background:#eee; border:none; padding:6px 10px; border-radius:8px; cursor:pointer;
        }
        .game-modal .modal-body { flex:1; background:#fff; position:relative; }
        .game-modal iframe { width:100%; height:100%; border:0; display:block; }
        .game-modal .fallback {
            position:absolute; inset:0; display:flex; align-items:center; justify-content:center; padding:20px; text-align:center; color:#666;
        }

        /* chess modal tweaks */
        #chessModalOverlay .game-modal { width: 760px; height: 640px; max-width: 96vw; max-height: 92vh; }
        #chessBoard { width: 100%; max-width: 640px; margin: 10px auto; }
        .chess-controls { display:flex; gap:8px; justify-content:center; padding:8px; }
        .chess-status { text-align:center; font-weight:600; margin-top:6px; color:#333; }
    </style>
    <!-- chessboard css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
</head>
<body>

<header>
    <div class="logo">Muybien</div>
    <div id="date-display" style="margin-left: auto; font-weight: 500; display:flex; gap:12px; align-items:center;">
        <div id="date-main">--</div>
        <div id="time-main" style="font-weight:600; font-size:13px;">--:--:--</div>
        <div id="weekday-main" style="opacity:0.9; font-size:13px;">â€”</div>
        <div id="holiday-main" style="opacity:0.9; font-size:13px; color:#ffd700;"> </div>
        <div id="lunar-main" style="opacity:0.8; font-size:12px;"> </div>
    </div>
    <div style="margin-left: 20px; display: flex; align-items: center; gap: 8px;">
        <select id="language-selector" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #999; background: #333; color: white; cursor: pointer; font-size: 14px;">
            <option value="en">English</option>
            <option value="zh">ä¸­æ–‡</option>
            <option value="ja">æ—¥æœ¬èª</option>
            <option value="ko">í•œêµ­ì–´</option>
            <option value="es">EspaÃ±ol</option>
        </select>
    </div>
</header>
    <div class="search-area">
        <div class="search-box-container">
            <div class="search-tabs">
                <span class="tab active" onclick="setEngine('google', this)">Google</span>
                <span class="tab" onclick="setEngine('bing', this)">Bing</span>
                <span class="tab" onclick="setEngine('duck', this)">Duck</span>
            </div>
            <div class="search-wrapper">
                <input id="main-search" class="search-input" placeholder="" />
                <button class="search-btn" onclick="performSearch()">Search</button>
            </div>
        </div>
    </div>
    <div class="quick-nav-container">
        <div class="quick-nav-bar">
        <a href="#ai-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg> AI Tools</a>
        <a href="#social-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg> Social</a>
        <a href="#crypto-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg> Crypto</a>
        <a href="#shopping-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-0.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-0.9-2-2-2z"/></svg> Shopping</a>
        <a href="#blog-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-5.04-6.71l-2.75 3.54-2.16-2.66c-.2-.25-.52-.25-.73 0l-1.97 2.36V7h5.5v5.29z"/></svg> Blogs</a>
        <a href="#business-category" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7V3H2v18h20V7h-10zm6 10h-4v4h-4v-4H6v-4h4V9h4v4h4v4z"/></svg> Business</a>
    </div>
</div>

<div class="container">
    <aside>
        <div class="weather-card" id="weather-card">
            <div id="weather-effects"></div>
            <div class="weather-card-content">
                <div style="font-size: 14px; opacity: 0.9;">Local Forecast</div>
                <div id="weather-city" style="font-weight: bold; font-size: 18px; cursor: pointer; padding: 8px; border-radius: 6px; transition: all 0.25s;" onmouseenter="this.style.background='rgba(255,255,255,0.2)'" onmouseleave="this.style.background='transparent'">Locating...</div>
                 <div class="temp" id="temp-display">--Â°C</div>
                 <div id="weather-desc" style="font-size: 14px;">Loading...</div>
            </div>
         </div>

         <div class="card" style="padding: 15px;">
            <div class="card-header" style="margin: -15px -15px 15px -15px; font-size: 15px; display:flex; justify-content:space-between; align-items:center;">
                <span>Daily Inspiration</span>
             </div>
             <div id="quote-container" style="padding-top: 10px; text-align: center;">
                 <!-- quote content container controls line-width -->
                 <div class="quote-content">
                     <div class="portrait-wrap">
                         <img id="quote-portrait"
                              src="https://avatars.dicebear.com/api/avataaars/Unknown.png?scale=80&background=%23ffffff"
                              alt="author portrait"
                              onerror="this.onerror=null;this.src='https://avatars.dicebear.com/api/identicon/Unknown.png?scale=80&background=%23ffffff'">
                     </div>
                    <div id="quote-text" style="font-style: italic; font-size: 14px; color: #444; line-height: 1.4; min-height: 60px; display: flex; align-items: center; justify-content: center;">"Loading wisdom..."</div>
                     <div id="quote-author" style="text-align: right; font-size: 12px; color: #888; margin-top: 8px; font-weight: bold;"></div>
                 </div>
             </div>
         </div>

         <div class="card" id="blogger-card" style="padding: 15px;">
            <div class="card-header" style="margin: -15px -15px 15px -15px; font-size: 15px; display: flex; align-items: center; justify-content: space-between;">
                 <div style="display:flex; align-items:center;">
                     <img src="https://www.google.com/s2/favicons?sz=64&domain=blogger.com" style="width:20px; height:20px; margin-right:8px;">
                     Blogger Posts
                 </div>
             </div>
             <div id="blogger-content" style="padding-top: 10px;">
                 <div style="font-size: 13px; color: #888;">Fetching...</div>
             </div>
         </div>
    </aside>

    <main>
        <!-- AI Category -->
        <div class="card" id="ai-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg> Artificial Intelligence</div>
            <div class="link-grid">
                <a href="https://chatgpt.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=openai.com">ChatGPT</a>
                <a href="https://claude.ai" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=anthropic.com">Claude AI</a>
                <a href="https://gemini.google.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=google.com">Gemini</a>
                <a href="https://www.perplexity.ai" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=perplexity.ai">Perplexity</a>
                <a href="https://www.blackbox.ai" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=blackbox.ai">Blackbox</a>
                <a href="https://copilot.microsoft.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=microsoft.com">Copilot</a>
                <a href="https://www.cohere.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=cohere.com">Cohere</a>
                <a href="https://mistral.ai" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=mistral.ai">Mistral</a>
            </div>
        </div>

        <!-- Social Category -->
        <div class="card" id="social-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg> Social Networks & Community</div>
            <div class="link-grid">
                <a href="https://www.facebook.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=facebook.com">Facebook</a>
                <a href="https://www.twitter.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=twitter.com">Twitter (X)</a>
                <a href="https://www.instagram.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=instagram.com">Instagram</a>
                <a href="https://www.reddit.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=reddit.com">Reddit</a>
                <a href="https://www.naver.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=naver.com">Naver (KR)</a>
                <a href="https://www.yahoo.co.jp" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=yahoo.co.jp">Yahoo! JP</a>
                <a href="https://www.dcinside.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=dcinside.com">DC Inside</a>
                <a href="https://www.2ch.sc" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=2ch.sc">2channel</a>
                <a href="https://www.linkedin.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=linkedin.com">LinkedIn</a>
                <a href="https://www.discord.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=discord.com">Discord</a>
             </div>
        </div>

        <!-- Crypto Category -->
        <div class="card" id="crypto-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg> Crypto & Web3 Ecosystem</div>
            <div class="link-grid">
                <a href="https://www.binance.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=binance.com">Binance</a>
                <a href="https://www.coinbase.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=coinbase.com">Coinbase</a>
                <a href="https://coinmarketcap.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=coinmarketcap.com">CoinMarketCap</a>
                <a href="https://www.upbit.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=upbit.com">Upbit (KR)</a>
                <a href="https://www.kraken.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=kraken.com">Kraken</a>
                <a href="https://www.bybit.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=bybit.com">Bybit</a>
                <a href="https://www.okx.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=okx.com">OKX</a>
                <a href="https://etherscan.io" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=etherscan.io">Etherscan</a>
             </div>
        </div>

        <!-- Shopping Category -->
        <div class="card" id="shopping-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-0.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-0.9-2-2-2z"/></svg> Global Shopping & Trade</div>
            <div class="link-grid">
                <a href="https://www.amazon.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=amazon.com">Amazon</a>
                <a href="https://www.ebay.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=ebay.com">eBay</a>
                <a href="https://www.rakuten.co.jp" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=rakuten.co.jp">Rakuten JP</a>
                <a href="https://www.coupang.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=coupang.com">Coupang KR</a>
                <a href="https://www.aliexpress.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=aliexpress.com">AliExpress</a>
                <a href="https://www.etsy.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=etsy.com">Etsy</a>
                <a href="https://www.shopee.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=shopee.com">Shopee</a>
                <a href="https://www.lazada.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=lazada.com">Lazada</a>
             </div>
        </div>

        <!-- Blog Category -->
        <div class="card" id="blog-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-5.04-6.71l-2.75 3.54-2.16-2.66c-.2-.25-.52-.25-.73 0l-1.97 2.36V7h5.5v5.29z"/></svg> Blogs & Reading</div>
            <div class="link-grid">
                <a href="https://medium.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=medium.com">Medium</a>
                <a href="https://www.blogger.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=blogger.com">Blogger</a>
                <a href="https://www.wordpress.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=wordpress.com">WordPress</a>
                <a href="https://note.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=note.com">Note (JP)</a>
                <a href="https://hashnode.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=hashnode.com">Hashnode</a>
                <a href="https://dev.to" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=dev.to">Dev.to</a>
                <a href="https://substack.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=substack.com">Substack</a>
                <a href="https://ghost.org" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=ghost.org">Ghost</a>
             </div>
        </div>

        <!-- Business & Consulting Category -->
        <div class="card" id="business-category">
            <div class="card-header"><svg class="header-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7V3H2v18h20V7h-10zm6 10h-4v4h-4v-4H6v-4h4V9h4v4h4v4z"/></svg> Business & Consulting</div>
            <div class="link-grid">
                <a href="https://www.mckinsey.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=mckinsey.com">McKinsey</a>
                <a href="https://www.bcg.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=bcg.com">Boston Consulting</a>
                <a href="https://www.bain.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=bain.com">Bain & Company</a>
                <a href="https://www.accenture.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=accenture.com">Accenture</a>
                <a href="https://www.pwc.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=pwc.com">PwC</a>
                <a href="https://www.forbes.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=forbes.com">Forbes</a>
                <a href="https://hbr.org" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=hbr.org">HBR</a>
                <a href="https://www.bloomberg.com" class="site-link"><img src="https://www.google.com/s2/favicons?sz=64&domain=bloomberg.com">Bloomberg</a>
             </div>
        </div>
    </main>

    <aside>
        <div class="card" style="height: auto;">
            <div class="card-header">Live Markets</div>
            <div class="tradingview-widget-container">
                <div class="tradingview-widget-container__widget"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                {
                  "colorTheme": "light", "dateRange": "12M", "showChart": false, "locale": "en", "width": "100%", "height": "300",
                  "isTransparent": true, "showSymbolLogo": true,
                  "tabs": [
                    { "title": "Markets", "symbols": [
                        { "s": "BINANCE:BTCUSDT", "d": "Bitcoin" }, { "s": "NASDAQ:NVDA", "d": "NVIDIA" },
                        { "s": "TVC:NI225", "d": "Nikkei 225" }, { "s": "NASDAQ:AAPL", "d": "Apple" }
                    ]}
                  ]
                }
                </script>
            </div>
        </div>

        <!-- Games Grid -->
        <div class="card" id="games-card" style="padding: 0;">
            <div class="card-header" style="font-size: 15px; display:flex; align-items:center;">ğŸ•¹ï¸ Games</div>
            <div class="games-grid" style="padding:16px;">
                <div class="game-tile" data-internal="chess" data-title="International Chess" aria-label="International Chess">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=chess.com" alt="chess">
                </div>
                <div class="game-tile" data-src="https://www.playok.com/en/xiangqi/" data-title="Chinese Xiangqi" aria-label="Chinese Xiangqi">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=playok.com" alt="playok">
                </div>
                <div class="game-tile" data-src="https://www.websudoku.com/" data-title="Sudoku" aria-label="Sudoku">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=websudoku.com" alt="websudoku">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="Minesweeper" aria-label="Minesweeper">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=minesweeperonline.com" alt="minesweeper">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="2048" aria-label="2048">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=play2048.co" alt="2048">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="Tetris" aria-label="Tetris">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=tetris.com" alt="tetris">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="Puzzle" aria-label="Puzzle">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=jigsawplanet.com" alt="puzzle">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="Card Game" aria-label="Card Game">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=cardgames.io" alt="cards">
                </div>
                <div class="game-tile" data-src="about:blank" data-title="Memory" aria-label="Memory">
                    <img src="https://www.google.com/s2/favicons?sz=128&domain=lumosity.com" alt="memory">
                </div>
            </div>
        </div>

        <!-- Game modal -->
        <div class="game-modal-overlay" id="gameModalOverlay" aria-hidden="true">
            <div class="game-modal" role="dialog" aria-modal="true" id="gameModal">
                <div class="modal-header">
                    <div class="modal-title" id="gameModalTitle">Game</div>
                    <button class="close-btn" id="gameModalClose">âœ•</button>
                </div>
                <div class="modal-body">
                    <iframe id="gameIframe" src="about:blank" title="game frame"></iframe>
                    <div class="fallback" id="gameFallback" style="display:none;">Unable to load the game. It may block embedding. Open in a new tab: <a id="gameOpenLink" href="#" target="_blank" rel="noopener">Open</a></div>
                </div>
            </div>
        </div>

        <!-- Chess modal (hidden by default) -->
        <div class="game-modal-overlay" id="chessModalOverlay" aria-hidden="true" style="display:none">
            <div class="game-modal" role="dialog" aria-modal="true" id="chessModal">
                <div class="modal-header">
                    <div class="modal-title" id="chessModalTitle">International Chess</div>
                    <div style="display:flex; gap:8px;">
                        <button class="close-btn" id="chessModalClose">âœ•</button>
                    </div>
                </div>
                <div class="modal-body" style="display:flex; flex-direction:column; align-items:stretch;">
                    <div id="chessBoard"></div>
                    <div class="chess-controls">
                        <button id="chessNew">New Game</button>
                        <button id="chessUndo">Undo</button>
                        <a id="chessOpenExternal" href="#" target="_blank" rel="noopener" style="align-self:center;">Open external</a>
                    </div>
                    <div class="chess-status" id="chessStatus">Ready</div>
                </div>
            </div>
        </div>
    </aside>
</div>

<!-- Game Modal (hidden by default) -->
<div class="game-modal-overlay" id="game-modal-overlay">
    <div class="game-modal" id="game-modal">
        <div class="modal-header">
            <div class="modal-title">Game</div>
            <button class="close-btn" id="close-modal">âœ–ï¸</button>
        </div>
        <div class="modal-body">
            <!-- Iframe for game content -->
            <iframe id="game-iframe" src="" frameborder="0" allowfullscreen></iframe>
            <!-- Fallback content while game is loading -->
            <div class="fallback">Loading game...</div>
        </div>
    </div>
</div>

<footer>
    <p>&copy; 2015 Muybien Personal Portal.</p>
</footer>

<script>
    // --- å¤šè¯­è¨€æ”¯æŒ ---
    const translations = {
        en: {
            'search_google': 'Search with Google...',
            'search_bing': 'Search with Bing...',
            'search_duck': 'Search with DuckDuckGo...',
            'google': 'Google',
            'bing': 'Bing',
            'duck': 'DuckDuckGo',
            'search_btn': 'Search',
            'home': 'Home',
            'ai_tools': 'AI Tools',
            'social': 'Social',
            'crypto': 'Crypto',
            'shopping': 'Shopping',
            'blogs': 'Blogs',
            'business': 'Business',
            'local_forecast': 'Local Forecast',
            'daily_inspiration': 'Daily Inspiration',
            'blogger_posts': 'Blogger Posts',
            'fetching': 'Fetching...',
            'no_posts': 'No posts available',
            'unable_load_posts': 'Unable to load posts',
            'ai_category': 'Artificial Intelligence',
            'social_category': 'Social Networks & Community',
            'crypto_category': 'Crypto & Web3 Ecosystem',
            'shopping_category': 'Global Shopping & Trade',
            'blog_category': 'Blogs & Reading',
            'business_category': 'Business & Consulting',
            'live_markets': 'Live Markets',
            'games': 'Games',
            'enter_city': 'Enter City Name:',
            'city_busy': 'Busy',
            'weather_unavailable': 'Unavailable',
            'weather_error': 'Error',
            'clear_sky': 'Clear sky',
            'mainly_clear': 'Mainly clear',
            'partly_cloudy': 'Partly cloudy',
            'overcast': 'Overcast',
            'fog': 'Fog',
            'depositing_rime_fog': 'Depositing rime fog',
            'light_drizzle': 'Light drizzle',
            'moderate_drizzle': 'Moderate drizzle',
            'dense_drizzle': 'Dense drizzle',
            'light_freezing_drizzle': 'Light freezing drizzle',
            'dense_freezing_drizzle': 'Dense freezing drizzle',
            'slight_rain': 'Slight rain',
            'moderate_rain': 'Moderate rain',
            'heavy_rain': 'Heavy rain',
            'light_freezing_rain': 'Light freezing rain',
            'heavy_freezing_rain': 'Heavy freezing rain',
            'slight_snow': 'Slight snow',
            'moderate_snow': 'Moderate snow',
            'heavy_snow': 'Heavy snow',
            'snow_grains': 'Snow grains',
            'slight_showers': 'Slight showers',
            'moderate_showers': 'Moderate showers',
            'violent_showers': 'Violent showers',
            'slight_snow_showers': 'Slight snow showers',
            'heavy_snow_showers': 'Heavy snow showers',
            'thunderstorm': 'Thunderstorm',
            'thunderstorm_slight_hail': 'Thunderstorm with slight hail',
            'thunderstorm_heavy_hail': 'Thunderstorm with heavy hail',
            'unknown': 'Unknown',
            'unable_load_quote': 'Unable to load quote',
            'loading_wisdom': 'Loading wisdom...',
            'international_chess': 'International Chess',
            'chinese_xiangqi': 'Chinese Xiangqi',
            'sudoku': 'Sudoku',
            'minesweeper': 'Minesweeper',
            'puzzle': 'Puzzle',
            'card_game': 'Card Game',
            'memory': 'Memory',
            'game': 'Game',
            'checkmate': 'Checkmate',
            'draw': 'Draw',
            'white': 'White',
            'black': 'Black',
            'check': 'Check',
            'new_game': 'New Game',
            'undo': 'Undo',
            'open_external': 'Open external',
            'ready': 'Ready',
            'locating': 'Locating...',
            'loading': 'Loading...',
            'unable_load_game': 'Unable to load the game. It may block embedding.',
            'open_in_new_tab': 'Open in a new tab',
            'open': 'Open',
            'loading_game': 'Loading game...',
            'press_keys': 'Press Keys',
            'holiday_today_prefix': 'Holiday:',
            'no_holiday_today': 'No holiday today',
            'lunar_unavailable': 'Lunar date unavailable',
            'copyright': 'Â© 2015 Muybien Personal Portal.'
        },
        zh: {
            'search_google': 'ç”¨Googleæœç´¢...',
            'search_bing': 'ç”¨Bingæœç´¢...',
            'search_duck': 'ç”¨DuckDuckGoæœç´¢...',
            'google': 'Google',
            'bing': 'Bing',
            'duck': 'DuckDuckGo',
            'search_btn': 'æœç´¢',
            'home': 'ä¸»é¡µ',
            'ai_tools': 'AIå·¥å…·',
            'social': 'ç¤¾äº¤',
            'crypto': 'åŠ å¯†è´§å¸',
            'shopping': 'è´­ç‰©',
            'blogs': 'åšå®¢',
            'business': 'å•†ä¸š',
            'local_forecast': 'æœ¬åœ°å¤©æ°”',
            'daily_inspiration': 'æ¯æ—¥çµæ„Ÿ',
            'blogger_posts': 'åšå®¢æ–‡ç« ',
            'fetching': 'åŠ è½½ä¸­...',
            'no_posts': 'æ²¡æœ‰æ–‡ç« ',
            'unable_load_posts': 'æ— æ³•åŠ è½½æ–‡ç« ',
            'ai_category': 'äººå·¥æ™ºèƒ½',
            'social_category': 'ç¤¾äº¤ç½‘ç»œä¸ç¤¾åŒº',
            'crypto_category': 'åŠ å¯†è´§å¸ä¸Web3ç”Ÿæ€',
            'shopping_category': 'å…¨çƒè´­ç‰©ä¸è´¸æ˜“',
            'blog_category': 'åšå®¢ä¸é˜…è¯»',
            'business_category': 'å•†ä¸šä¸å’¨è¯¢',
            'live_markets': 'å®æ—¶è¡Œæƒ…',
            'games': 'æ¸¸æˆ',
            'enter_city': 'è¾“å…¥åŸå¸‚åç§°:',
            'city_busy': 'ç¹å¿™',
            'weather_unavailable': 'ä¸å¯ç”¨',
            'weather_error': 'é”™è¯¯',
            'clear_sky': 'æ™´æœ—',
            'mainly_clear': 'ä¸»è¦æ™´æœ—',
            'partly_cloudy': 'éƒ¨åˆ†å¤šäº‘',
            'overcast': 'é˜´å¤©',
            'fog': 'æœ‰é›¾',
            'depositing_rime_fog': 'æ²‰ç§¯éœœå†»é›¾',
            'light_drizzle': 'å°æ¯›æ¯›é›¨',
            'moderate_drizzle': 'ä¸­ç­‰æ¯›æ¯›é›¨',
            'dense_drizzle': 'å¯†é›†æ¯›æ¯›é›¨',
            'light_freezing_drizzle': 'å°å†»æ¯›æ¯›é›¨',
            'dense_freezing_drizzle': 'å¯†é›†å†»æ¯›æ¯›é›¨',
            'slight_rain': 'å°é›¨',
            'moderate_rain': 'ä¸­é›¨',
            'heavy_rain': 'å¤§é›¨',
            'light_freezing_rain': 'å°å†»é›¨',
            'heavy_freezing_rain': 'å¤§å†»é›¨',
            'slight_snow': 'å°é›ª',
            'moderate_snow': 'ä¸­é›ª',
            'heavy_snow': 'å¤§é›ª',
            'snow_grains': 'é›ªç²’',
            'slight_showers': 'å°é˜µé›¨',
            'moderate_showers': 'ä¸­ç­‰é˜µé›¨',
            'violent_showers': 'å¼ºé˜µé›¨',
            'slight_snow_showers': 'å°é˜µé›ª',
            'heavy_snow_showers': 'å¤§é˜µé›ª',
            'thunderstorm': 'é›·æš´',
            'thunderstorm_slight_hail': 'é›·æš´ä¼´å°å†°é›¹',
            'thunderstorm_heavy_hail': 'é›·æš´ä¼´å¤§å†°é›¹',
            'unknown': 'æœªçŸ¥',
            'unable_load_quote': 'æ— æ³•åŠ è½½å¼•è¨€',
            'loading_wisdom': 'åŠ è½½æ™ºæ…§ä¸­...',
            'international_chess': 'å›½é™…è±¡æ£‹',
            'chinese_xiangqi': 'ä¸­å›½è±¡æ£‹',
            'sudoku': 'æ•°ç‹¬',
            'minesweeper': 'æ‰«é›·',
            'puzzle': 'æ‹¼å›¾',
            'card_game': 'çº¸ç‰Œæ¸¸æˆ',
            'memory': 'è®°å¿†',
            'game': 'æ¸¸æˆ',
            'checkmate': 'å°†æ­»',
            'draw': 'å¹³å±€',
            'white': 'ç™½æ–¹',
            'black': 'é»‘æ–¹',
            'check': 'å°†å†›',
            'new_game': 'æ–°æ¸¸æˆ',
            'undo': 'æ’¤é”€',
            'open_external': 'åœ¨å¤–éƒ¨æ‰“å¼€',
            'ready': 'å°±ç»ª',
            'locating': 'å®šä½ä¸­...',
            'loading': 'åŠ è½½ä¸­...',
            'unable_load_game': 'æ— æ³•åŠ è½½æ¸¸æˆã€‚å¯èƒ½ä¼šé˜»æ­¢åµŒå…¥ã€‚',
            'open_in_new_tab': 'åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€',
            'open': 'æ‰“å¼€',
            'loading_game': 'æ­£åœ¨åŠ è½½æ¸¸æˆ...',
            'press_keys': 'æŒ‰é”®å¼€å§‹',
            'holiday_today_prefix': 'èŠ‚æ—¥ï¼š',
            'no_holiday_today': 'ä»Šæ—¥æ— èŠ‚å‡æ—¥',
            'lunar_unavailable': 'æ— æ³•æ˜¾ç¤ºå†œå†',
            'copyright': 'Â© 2015 Muybien ä¸ªäººé—¨æˆ·ã€‚'
        },
        ja: {
            'search_google': 'Googleã§æ¤œç´¢...',
            'search_bing': 'Bingã§æ¤œç´¢...',
            'search_duck': 'DuckDuckGoã§æ¤œç´¢...',
            'google': 'Google',
            'bing': 'Bing',
            'duck': 'DuckDuckGo',
            'search_btn': 'æ¤œç´¢',
            'home': 'ãƒ›ãƒ¼ãƒ ',
            'ai_tools': 'AIãƒ„ãƒ¼ãƒ«',
            'social': 'ã‚½ãƒ¼ã‚·ãƒ£ãƒ«',
            'crypto': 'æš—å·è³‡ç”£',
            'shopping': 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°',
            'blogs': 'ãƒ–ãƒ­ã‚°',
            'business': 'ãƒ“ã‚¸ãƒã‚¹',
            'local_forecast': 'ãƒ­ãƒ¼ã‚«ãƒ«å¤©æ°—äºˆå ±',
            'daily_inspiration': 'æ¯æ—¥ã®ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',
            'blogger_posts': 'ãƒ–ãƒ­ã‚¬ãƒ¼ã®æŠ•ç¨¿',
            'fetching': 'èª­ã¿è¾¼ã¿ä¸­...',
            'no_posts': 'æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“',
            'unable_load_posts': 'æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“',
            'ai_category': 'äººå·¥çŸ¥èƒ½',
            'social_category': 'ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ & ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£',
            'crypto_category': 'æš—å·è³‡ç”£ & Web3 ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ',
            'shopping_category': 'ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚° & è²¿æ˜“',
            'blog_category': 'ãƒ–ãƒ­ã‚° & èª­æ›¸',
            'business_category': 'ãƒ“ã‚¸ãƒã‚¹ & ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°',
            'live_markets': 'ãƒ©ã‚¤ãƒ–ãƒãƒ¼ã‚±ãƒƒãƒˆ',
            'games': 'ã‚²ãƒ¼ãƒ ',
            'enter_city': 'ã‚·ãƒ†ã‚£åã‚’å…¥åŠ›:',
            'city_busy': 'æ··é›‘ä¸­',
            'weather_unavailable': 'åˆ©ç”¨ã§ãã¾ã›ã‚“',
            'weather_error': 'ã‚¨ãƒ©ãƒ¼',
            'clear_sky': 'æ™´å¤©',
            'mainly_clear': 'ä¸»ã«æ™´å¤©',
            'partly_cloudy': 'æ›‡ã‚ŠãŒã¡',
            'overcast': 'æ›‡ã‚Š',
            'fog': 'éœ§',
            'depositing_rime_fog': 'ãƒªãƒ éœ§ã®å †ç©',
            'light_drizzle': 'å°é›¨',
            'moderate_drizzle': 'éœ§é›¨ï¼ˆä¸­ç¨‹åº¦ï¼‰',
            'dense_drizzle': 'éœ§é›¨ï¼ˆæ¿ƒã„ï¼‰',
            'light_freezing_drizzle': 'å‡çµå°é›¨',
            'dense_freezing_drizzle': 'å‡çµéœ§é›¨ï¼ˆæ¿ƒã„ï¼‰',
            'slight_rain': 'å¼±ã„é›¨',
            'moderate_rain': 'ä¸­ç¨‹åº¦ã®é›¨',
            'heavy_rain': 'å¤§é›¨',
            'light_freezing_rain': 'å¼±ã„å‡çµé›¨',
            'heavy_freezing_rain': 'å¼·ã„å‡çµé›¨',
            'slight_snow': 'å¼±ã„é›ª',
            'moderate_snow': 'ä¸­ç¨‹åº¦ã®é›ª',
            'heavy_snow': 'å¤§é›ª',
            'snow_grains': 'ç²‰é›ª',
            'slight_showers': 'å¼±ã„ã‚·ãƒ£ãƒ¯ãƒ¼',
            'moderate_showers': 'ä¸­ç¨‹åº¦ã®ã‚·ãƒ£ãƒ¯ãƒ¼',
            'violent_showers': 'æ¿€ã—ã„ã‚·ãƒ£ãƒ¯ãƒ¼',
            'slight_snow_showers': 'å¼±ã„é›ªã®ã‚·ãƒ£ãƒ¯ãƒ¼',
            'heavy_snow_showers': 'å¼·ã„é›ªã®ã‚·ãƒ£ãƒ¯ãƒ¼',
            'thunderstorm': 'é›·åµ',
            'thunderstorm_slight_hail': 'é›·åµã¨å°ã²ã‚‡ã†',
            'thunderstorm_heavy_hail': 'é›·åµã¨å¤§ã²ã‚‡ã†',
            'unknown': 'ä¸æ˜',
            'unable_load_quote': 'å¼•ç”¨ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“',
            'loading_wisdom': 'çŸ¥æµã‚’èª­ã¿è¾¼ã¿ä¸­...',
            'international_chess': 'å›½éš›ãƒã‚§ã‚¹',
            'chinese_xiangqi': 'ä¸­å›½è±¡æ£‹',
            'sudoku': 'æ•°ç‹¬',
            'minesweeper': 'ãƒã‚¤ãƒ³ã‚¹ã‚¤ãƒ¼ãƒ‘ãƒ¼',
            'puzzle': 'ãƒ‘ã‚ºãƒ«',
            'card_game': 'ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ',
            'memory': 'ãƒ¡ãƒ¢ãƒªãƒ¼',
            'game': 'ã‚²ãƒ¼ãƒ ',
            'checkmate': 'ãƒã‚§ãƒƒã‚¯ãƒ¡ã‚¤ãƒˆ',
            'draw': 'å¼•ãåˆ†ã‘',
            'white': 'ãƒ›ãƒ¯ã‚¤ãƒˆ',
            'black': 'ãƒ–ãƒ©ãƒƒã‚¯',
            'check': 'ãƒã‚§ãƒƒã‚¯',
            'new_game': 'æ–°ã—ã„ã‚²ãƒ¼ãƒ ',
            'undo': 'æˆ»ã™',
            'open_external': 'å¤–éƒ¨ã§é–‹ã',
            'ready': 'æº–å‚™å®Œäº†',
            'locating': 'ç¾åœ¨åœ°ã‚’å–å¾—ä¸­...',
            'loading': 'èª­ã¿è¾¼ã¿ä¸­...',
            'unable_load_game': 'ã‚²ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã€‚åŸ‹ã‚è¾¼ã¿ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',
            'open_in_new_tab': 'æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã',
            'open': 'é–‹ã',
            'loading_game': 'ã‚²ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã¿ä¸­...',
            'press_keys': 'ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„',
            'holiday_today_prefix': 'ç¥æ—¥ï¼š',
            'no_holiday_today': 'ä»Šæ—¥ã¯ç¥æ—¥ã§ã¯ã‚ã‚Šã¾ã›ã‚“',
            'lunar_unavailable': 'æ—§æš¦ã‚’è¡¨ç¤ºã§ãã¾ã›ã‚“',
            'copyright': 'Â© 2015 Muybien ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ãƒãƒ¼ã‚¿ãƒ«ã€‚'
        },
        ko: {
            'search_google': 'Googleë¡œ ê²€ìƒ‰...',
            'search_bing': 'Bingìœ¼ë¡œ ê²€ìƒ‰...',
            'search_duck': 'DuckDuckGoë¡œ ê²€ìƒ‰...',
            'google': 'Google',
            'bing': 'Bing',
            'duck': 'DuckDuckGo',
            'search_btn': 'ê²€ìƒ‰',
            'home': 'í™ˆ',
            'ai_tools': 'AI ë„êµ¬',
            'social': 'ì†Œì…œ',
            'crypto': 'ì•”í˜¸í™”í',
            'shopping': 'ì‡¼í•‘',
            'blogs': 'ë¸”ë¡œê·¸',
            'business': 'ë¹„ì¦ˆë‹ˆìŠ¤',
            'local_forecast': 'ì§€ì—­ ë‚ ì”¨',
            'daily_inspiration': 'ë§¤ì¼ì˜ ì˜ê°',
            'blogger_posts': 'ë¸”ë¡œê±° í¬ìŠ¤íŠ¸',
            'fetching': 'ë¡œë“œ ì¤‘...',
            'no_posts': 'ê²Œì‹œë¬¼ ì—†ìŒ',
            'unable_load_posts': 'ê²Œì‹œë¬¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
            'ai_category': 'ì¸ê³µì§€ëŠ¥',
            'social_category': 'ì†Œì…œ ë„¤íŠ¸ì›Œí¬ & ì»¤ë®¤ë‹ˆí‹°',
            'crypto_category': 'ì•”í˜¸í™”í & Web3 ìƒíƒœê³„',
            'shopping_category': 'ê¸€ë¡œë²Œ ì‡¼í•‘ & ë¬´ì—­',
            'blog_category': 'ë¸”ë¡œê·¸ & ì½ê¸°',
            'business_category': 'ë¹„ì¦ˆë‹ˆìŠ¤ & ì»¨ì„¤íŒ…',
            'live_markets': 'ë¼ì´ë¸Œ ì‹œì¥',
            'games': 'ê²Œì„',
            'enter_city': 'ë„ì‹œ ì´ë¦„ ì…ë ¥:',
            'city_busy': 'ë°”ìœ',
            'weather_unavailable': 'ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ',
            'weather_error': 'ì˜¤ë¥˜',
            'clear_sky': 'ë§‘ìŒ',
            'mainly_clear': 'ì£¼ë¡œ ë§‘ìŒ',
            'partly_cloudy': 'ë¶€ë¶„ì ìœ¼ë¡œ íë¦¼',
            'overcast': 'íë¦¼',
            'fog': 'ì•ˆê°œ',
            'depositing_rime_fog': 'ì„œë¦¬ ì•ˆê°œ ì¹¨ì „',
            'light_drizzle': 'ê°€ë²¼ìš´ ì´ìŠ¬',
            'moderate_drizzle': 'ì¤‘ê°„ ì´ìŠ¬',
            'dense_drizzle': 'ì§™ì€ ì´ìŠ¬',
            'light_freezing_drizzle': 'ê°€ë²¼ìš´ ë¹™ê²° ì´ìŠ¬',
            'dense_freezing_drizzle': 'ì§™ì€ ë¹™ê²° ì´ìŠ¬',
            'slight_rain': 'ì•½í•œ ë¹„',
            'moderate_rain': 'ë³´í†µ ë¹„',
            'heavy_rain': 'í­ìš°',
            'light_freezing_rain': 'ì•½í•œ ë¹™ê²°ìš°',
            'heavy_freezing_rain': 'ê°•í•œ ë¹™ê²°ìš°',
            'slight_snow': 'ì•½í•œ ëˆˆ',
            'moderate_snow': 'ë³´í†µ ëˆˆ',
            'heavy_snow': 'í­ì„¤',
            'snow_grains': 'ëˆˆ ì…ì',
            'slight_showers': 'ì•½í•œ ì†Œë‚˜ê¸°',
            'moderate_showers': 'ë³´í†µ ì†Œë‚˜ê¸°',
            'violent_showers': 'í­ìš°',
            'slight_snow_showers': 'ì•½í•œ ëˆˆ ì†Œë‚˜ê¸°',
            'heavy_snow_showers': 'ê°•í•œ ëˆˆ ì†Œë‚˜ê¸°',
            'thunderstorm': 'ì²œë‘¥í­í’',
            'thunderstorm_slight_hail': 'ì•½í•œ ìš°ë°•ì´ ìˆëŠ” ì²œë‘¥í­í’',
            'thunderstorm_heavy_hail': 'ê°•í•œ ìš°ë°•ì´ ìˆëŠ” ì²œë‘¥í­í’',
            'unknown': 'ì•Œ ìˆ˜ ì—†ìŒ',
            'unable_load_quote': 'ì¸ìš©ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
            'loading_wisdom': 'ì§€í˜œ ë¡œë“œ ì¤‘...',
            'international_chess': 'êµ­ì œ ì²´ìŠ¤',
            'chinese_xiangqi': 'ì¤‘êµ­ ìƒì§•',
            'sudoku': 'ìŠ¤ë„ì¿ ',
            'minesweeper': 'ì§€ë¢°ì°¾ê¸°',
            'puzzle': 'í¼ì¦',
            'card_game': 'ì¹´ë“œ ê²Œì„',
            'memory': 'ë©”ëª¨ë¦¬',
            'game': 'ê²Œì„',
            'checkmate': 'ì²´í¬ë©”ì´íŠ¸',
            'draw': 'ë¹„ê¹€',
            'white': 'ë°±',
            'black': 'í‘',
            'check': 'ì²´í¬',
            'new_game': 'ìƒˆ ê²Œì„',
            'undo': 'ì‹¤í–‰ ì·¨ì†Œ',
            'open_external': 'ì™¸ë¶€ì—ì„œ ì—´ê¸°',
            'ready': 'ì¤€ë¹„ë¨',
            'locating': 'ìœ„ì¹˜ í™•ì¸ ì¤‘...',
            'loading': 'ë¡œë“œ ì¤‘...',
            'unable_load_game': 'ê²Œì„ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„ë² ë”©ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
            'open_in_new_tab': 'ìƒˆ íƒ­ì—ì„œ ì—´ê¸°',
            'open': 'ì—´ê¸°',
            'loading_game': 'ê²Œì„ ë¡œë“œ ì¤‘...',
            'press_keys': 'í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”',
            'holiday_today_prefix': 'ê³µíœ´ì¼:',
            'no_holiday_today': 'ì˜¤ëŠ˜ ê³µíœ´ì¼ ì—†ìŒ',
            'lunar_unavailable': 'ìŒë ¥ ë‚ ì§œë¥¼ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
            'copyright': 'Â© 2015 Muybien ê°œì¸ í¬í„¸.'
        },
        es: {
            'search_google': 'Buscar con Google...',
            'search_bing': 'Buscar con Bing...',
            'search_duck': 'Buscar con DuckDuckGo...',
            'google': 'Google',
            'bing': 'Bing',
            'duck': 'DuckDuckGo',
            'search_btn': 'Buscar',
            'home': 'Inicio',
            'ai_tools': 'Herramientas IA',
            'social': 'Social',
            'crypto': 'Criptos',
            'shopping': 'Compras',
            'blogs': 'Blogs',
            'business': 'Negocios',
            'local_forecast': 'PronÃ³stico Local',
            'daily_inspiration': 'InspiraciÃ³n Diaria',
            'blogger_posts': 'Publicaciones de Blogger',
            'fetching': 'Cargando...',
            'no_posts': 'Sin publicaciones',
            'unable_load_posts': 'No se pueden cargar publicaciones',
            'ai_category': 'Inteligencia Artificial',
            'social_category': 'Redes Sociales & Comunidad',
            'crypto_category': 'Criptos & Ecosistema Web3',
            'shopping_category': 'Compras Globales & Comercio',
            'blog_category': 'Blogs & Lecturas',
            'business_category': 'Negocios & ConsultorÃ­a',
            'live_markets': 'Mercados en Vivo',
            'games': 'Juegos',
            'enter_city': 'Ingrese nombre de ciudad:',
            'city_busy': 'Ocupado',
            'weather_unavailable': 'No disponible',
            'weather_error': 'Error',
            'clear_sky': 'Cielo despejado',
            'mainly_clear': 'Principalmente despejado',
            'partly_cloudy': 'Parcialmente nublado',
            'overcast': 'Nublado',
            'fog': 'Neblina',
            'depositing_rime_fog': 'DepÃ³sito de escarcha',
            'light_drizzle': 'Llovizna ligera',
            'moderate_drizzle': 'Llovizna moderada',
            'dense_drizzle': 'Llovizna densa',
            'light_freezing_drizzle': 'Llovizna congelante ligera',
            'dense_freezing_drizzle': 'Llovizna congelante densa',
            'slight_rain': 'Lluvia leve',
            'moderate_rain': 'Lluvia moderada',
            'heavy_rain': 'Lluvia fuerte',
            'light_freezing_rain': 'Lluvia congelante ligera',
            'heavy_freezing_rain': 'Lluvia congelante fuerte',
            'slight_snow': 'Nieve leve',
            'moderate_snow': 'Nieve moderada',
            'heavy_snow': 'Nevada fuerte',
            'snow_grains': 'GrÃ¡nulos de nieve',
            'slight_showers': 'Chaparrones leves',
            'moderate_showers': 'Chaparrones moderados',
            'violent_showers': 'Chaparrones violentos',
            'slight_snow_showers': 'Chaparrones de nieve leve',
            'heavy_snow_showers': 'Chaparrones de nieve fuerte',
            'thunderstorm': 'Tormenta elÃ©ctrica',
            'thunderstorm_slight_hail': 'Tormenta elÃ©ctrica con granizo leve',
            'thunderstorm_heavy_hail': 'Tormenta elÃ©ctrica con granizo fuerte',
            'unknown': 'Desconocido',
            'unable_load_quote': 'No se puede cargar la cita',
            'loading_wisdom': 'Cargando sabidurÃ­a...',
            'international_chess': 'Ajedrez Internacional',
            'chinese_xiangqi': 'Xiangqi Chino',
            'sudoku': 'Sudoku',
            'minesweeper': 'Buscaminas',
            'puzzle': 'Puzzle',
            'card_game': 'Juego de Cartas',
            'memory': 'Memoria',
            'game': 'Juego',
            'checkmate': 'Jaque Mate',
            'draw': 'Tablas',
            'white': 'Blanco',
            'black': 'Negro',
            'check': 'Jaque',
            'new_game': 'Nuevo Juego',
            'undo': 'Deshacer',
            'open_external': 'Abrir externo',
            'ready': 'Listo',
            'locating': 'Localizando...',
            'loading': 'Cargando...',
            'unable_load_game': 'No se puede cargar el juego. Puede bloquear la incrustaciÃ³n.',
            'open_in_new_tab': 'Abrir en una pestaÃ±a nueva',
            'open': 'Abrir',
            'loading_game': 'Cargando juego...',
            'press_keys': 'Presione teclas',
            'holiday_today_prefix': 'Festivo:',
            'no_holiday_today': 'No hay festivos hoy',
            'lunar_unavailable': 'Fecha lunar no disponible',
            'copyright': 'Â© 2015 Portal Personal Muybien.'
        }
    };

    let currentLanguage = localStorage.getItem('selectedLanguage') || 'en';

    const dateLocaleMap = { en: 'en-US', zh: 'zh-CN', ja: 'ja-JP', ko: 'ko-KR', es: 'es-ES' };

    // store last fetched weather code so we can re-translate on language change
    let lastWeatherCode = null;
    let lastHolidayName = null;

    function t(key) {
        return translations[currentLanguage][key] || translations['en'][key] || key;
    }

    function changeLanguage(lang) {
        currentLanguage = lang;
        localStorage.setItem('selectedLanguage', lang);
        updateUIText();
    }

    function updateUIText() {
        // æ›´æ–°æœç´¢æ ‡ç­¾
        document.querySelectorAll('.tab')[0].textContent = t('google');
        document.querySelectorAll('.tab')[1].textContent = t('bing');
        document.querySelectorAll('.tab')[2].textContent = t('duck');

        // æ›´æ–°æœç´¢è¾“å…¥æ¡†å ä½ç¬¦
        document.getElementById('main-search').placeholder = t('search_' + currentEngine);

        // æ›´æ–°æœç´¢æŒ‰é’®
        document.querySelector('.search-btn').textContent = t('search_btn');

        // æ›´æ–°å¯¼èˆªæ 
        const navItems = document.querySelectorAll('.nav-item');
        const navTexts = [t('home'), t('ai_tools'), t('social'), t('crypto'), t('shopping'), t('blogs'), t('business')];
        navItems.forEach((item, i) => {
            if (i < navTexts.length) {
                const svg = item.querySelector('svg');
                item.innerHTML = svg ? svg.outerHTML : '';
                const textNode = document.createTextNode(' ' + navTexts[i]);
                item.appendChild(textNode);
            }
        });

        // æ›´æ–°åˆ†ç±»æ ‡é¢˜
        const headers = document.querySelectorAll('.card-header');
        const categoryNames = [t('ai_category'), t('social_category'), t('crypto_category'), t('shopping_category'), t('blog_category'), t('business_category')];
        
        // Find headers that contain SVG icons
        let headerIndex = 0;
        headers.forEach((header) => {
            if (header.querySelector('svg') && headerIndex < categoryNames.length) {
                const svg = header.querySelector('svg');
                header.innerHTML = svg.outerHTML + ' ' + categoryNames[headerIndex];
                headerIndex++;
            }
        });

        // æ›´æ–°ä¾§è¾¹æ æ ‡é¢˜å’Œå†…å®¹
        const asides = document.querySelectorAll('aside');
        
        // æ›´æ–°weather cardæ ‡ç­¾
        const weatherCardLabel = document.querySelector('.weather-card > div:first-child');
        if (weatherCardLabel) {
            weatherCardLabel.textContent = t('local_forecast');
        }

        // æ›´æ–°Daily Inspiration
        const dailyCard = asides[0].querySelector('.card');
        if (dailyCard) {
            const dailyHeader = dailyCard.querySelector('.card-header span');
            if (dailyHeader) dailyHeader.textContent = t('daily_inspiration');
        }

        // æ›´æ–°Blogger Posts
        const bloggerCard = document.getElementById('blogger-card');
        if (bloggerCard) {
            const headerImg = bloggerCard.querySelector('img');
            const headerContent = headerImg ? headerImg.outerHTML + ' ' : '';
            bloggerCard.querySelector('.card-header').innerHTML = headerContent + t('blogger_posts');
        }

        // æ›´æ–°Live Marketså’ŒGamesï¼ˆå³ä¾§è¾¹æ ï¼‰
        if (asides.length > 1) {
            const rightCards = asides[1].querySelectorAll('.card');
            if (rightCards.length > 0) {
                rightCards[0].querySelector('.card-header').textContent = t('live_markets');
            }
            if (rightCards.length > 1) {
                rightCards[1].querySelector('.card-header').textContent = 'ğŸ•¹ï¸ ' + t('games');
            }
        }

        // é¢å¤–å¯ç¿»è¯‘çš„é™æ€æ–‡æœ¬ï¼ˆå¤©æ°”ã€å¼•è¨€ã€æ¸¸æˆå›é€€ä¸é“¾æ¥ï¼‰
        const weatherCity = document.getElementById('weather-city');
        if (weatherCity) {
            const txt = weatherCity.innerText.trim();
            if (!txt || /locat/i.test(txt) || txt.length < 2) weatherCity.innerText = t('locating');
        }
        const weatherDesc = document.getElementById('weather-desc');
        if (weatherDesc) {
            const d = weatherDesc.innerText.trim();
            if (!d || /load/i.test(d)) weatherDesc.innerText = t('loading');
        }

        // å¼•è¨€åˆå§‹æ–‡æœ¬ï¼ˆä¼šè¢«å¼‚æ­¥æ›´æ–°ï¼‰
        const quoteText = document.getElementById('quote-text');
        if (quoteText) quoteText.innerText = '"' + t('loading_wisdom') + '"';

        // æ¸¸æˆå›é€€æ–‡æ¡ˆä¸é“¾æ¥
        const gameFallback = document.getElementById('gameFallback');
        if (gameFallback) {
            const openLabel = '<a id="gameOpenLink" href="#" target="_blank" rel="noopener">' + t('open') + '</a>';
            gameFallback.innerHTML = t('unable_load_game') + ' ' + t('open_in_new_tab') + ': ' + openLabel;
        }
        const gameModalFallbacks = document.querySelectorAll('#game-modal .fallback');
        gameModalFallbacks.forEach(f => { f.innerText = t('loading_game'); });
        const gameOpenLink = document.getElementById('gameOpenLink');
        if (gameOpenLink) gameOpenLink.textContent = t('open');

        // chess external link label
        const chessOpenExternal = document.getElementById('chessOpenExternal');
        if (chessOpenExternal) chessOpenExternal.textContent = t('open_external');

        // æ›´æ–°æ—¥æœŸ/æ—¶é—´/å‘¨/å†œå†æ˜¾ç¤ºä¸ºå½“å‰è¯­è¨€æ ¼å¼
        const localeForDate = dateLocaleMap[currentLanguage] || 'en-US';
        const dateMain = document.getElementById('date-main');
        const timeMain = document.getElementById('time-main');
        const weekdayMain = document.getElementById('weekday-main');
        const lunarMain = document.getElementById('lunar-main');
        if (dateMain) dateMain.innerText = new Date().toLocaleDateString(localeForDate, {month:'long', day: 'numeric', year: 'numeric'});
        if (timeMain) timeMain.innerText = new Date().toLocaleTimeString(localeForDate);
        if (weekdayMain) weekdayMain.innerText = new Date().toLocaleDateString(localeForDate, {weekday:'long'});

        // å†œå†ï¼ˆåªåœ¨ä¸­æ–‡æ˜¾ç¤ºå°è¯•ä½¿ç”¨ Intl with chinese calendar, å¦åˆ™æ˜¾ç¤ºunavailableï¼‰
        if (lunarMain) {
            if (currentLanguage === 'zh') {
                try {
                    const opts = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', {month:'long', day:'numeric'});
                    lunarMain.innerText = opts.format(new Date());
                } catch (e) {
                    lunarMain.innerText = t('lunar_unavailable');
                }
            } else {
                lunarMain.innerText = '';
            }
        }

        // å¦‚æœå·²æœ‰å¤©æ°”ä»£ç ï¼Œé‡æ–°ç¿»è¯‘å¤©æ°”æè¿°å¹¶æ›´æ–°æ•ˆæœ
        if (lastWeatherCode !== null) {
            const weatherDescEl = document.getElementById('weather-desc');
            if (weatherDescEl) weatherDescEl.innerText = weatherCodeToDesc(lastWeatherCode);
            generateWeatherEffects(lastWeatherCode);
        }

        // æ›´æ–°é¡µè„š
        const footer = document.querySelector('footer p');
        if (footer) footer.textContent = t('copyright');
    }

    // --- Clock and Holidays ---
    function startClock() {
        setInterval(() => {
            const localeForDate = dateLocaleMap[currentLanguage] || 'en-US';
            const timeMain = document.getElementById('time-main');
            const dateMain = document.getElementById('date-main');
            const weekdayMain = document.getElementById('weekday-main');
            if (timeMain) timeMain.innerText = new Date().toLocaleTimeString(localeForDate);
            if (dateMain) dateMain.innerText = new Date().toLocaleDateString(localeForDate, {month:'long', day: 'numeric', year: 'numeric'});
            if (weekdayMain) weekdayMain.innerText = new Date().toLocaleDateString(localeForDate, {weekday:'long'});
            // update lunar each tick only when zh
            const lunarMain = document.getElementById('lunar-main');
            if (lunarMain && currentLanguage === 'zh') {
                try { lunarMain.innerText = new Intl.DateTimeFormat('zh-CN-u-ca-chinese', {month:'long', day:'numeric'}).format(new Date()); }
                catch(e) { lunarMain.innerText = t('lunar_unavailable'); }
            }
        }, 1000);
    }

    async function fetchCountryAndHolidays() {
        try {
            const res = await fetch('https://ipwho.is/');
            const j = await res.json();
            const cc = j && j.country_code ? j.country_code : null;
            if (cc) fetchHolidays(cc);
        } catch (e) { console.warn('Failed to fetch country for holidays', e); }
    }

    async function fetchHolidays(countryCode) {
        try {
            const year = new Date().getFullYear();
            // Nager.Date public holidays API
            const res = await fetch(`https://date.nager.at/api/v3/PublicHolidays/${year}/${countryCode}`);
            if (!res.ok) return;
            const list = await res.json();
            // find today
            const today = new Date().toISOString().slice(0,10);
            const match = list.find(h => h.date === today);
            const holidayEl = document.getElementById('holiday-main');
            if (holidayEl) {
                if (match) {
                    lastHolidayName = (match.localName || match.name);
                    holidayEl.innerText = t('holiday_today_prefix') + ' ' + lastHolidayName;
                } else {
                    lastHolidayName = null;
                    holidayEl.innerText = t('no_holiday_today');
                }
            }
        } catch (e) { console.warn('Holiday fetch error', e); }
    }

    // --- æœç´¢å¼•æ“ ---
    let currentEngine = 'google';
    const searchInput = document.getElementById('main-search');
    const searchBtn = document.querySelector('.search-btn');
    function setEngine(engine, el) {
        currentEngine = engine;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
        const colors = { 'duck': '#de5833', 'bing': '#00809d', 'google': '#4285f4' };
        searchBtn.style.background = `linear-gradient(to bottom, ${colors[engine]}, #333)`;
        searchInput.placeholder = t('search_' + engine);
    }
    function performSearch() {
        const q = searchInput.value;
        if(!q) return;
        const urls = {
            'google': `https://www.google.com/search?q=${encodeURIComponent(q)}`,
            'bing': `https://www.bing.com/search?q=${encodeURIComponent(q)}`,
            'duck': `https://duckduckgo.com/?q=${encodeURIComponent(q)}`
        };
        window.open(urls[currentEngine], '_blank');
    }
    searchInput.onkeydown = (e) => { if(e.key === 'Enter') performSearch(); };

    // --- å¤©æ°” ---
    async function initWeather() {
        const cityEl = document.getElementById('weather-city');
        cityEl.onclick = changeCity;
        const savedCity = localStorage.getItem('user_city_data');
        if (savedCity) {
            const data = JSON.parse(savedCity);
            fetchWeatherData(data.lat, data.lon, data.name);
        } else {
            try {
                const res = await fetch('https://ipwho.is/');
                const data = await res.json();
                if (data.success) fetchWeatherData(data.latitude, data.longitude, data.city);
            } catch (e) { fetchWeatherData(35.68, 139.76, "Tokyo"); }
        }
    }
    async function changeCity() {
        const newCity = prompt(t('enter_city'));
        if (!newCity) return;
        try {
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(newCity)}&limit=1`);
            const data = await res.json();
            if (data.length > 0) {
                const cityData = { lat: data[0].lat, lon: data[0].lon, name: data[0].display_name.split(',')[0] };
                localStorage.setItem('user_city_data', JSON.stringify(cityData));
                fetchWeatherData(cityData.lat, cityData.lon, cityData.name);
            }
        } catch (e) { alert(t('city_busy')); }
    }

    // --- Weather description mapping ---
    function weatherCodeToDesc(code) {
        const map = {
            0: 'clear_sky', 1: 'mainly_clear', 2: 'partly_cloudy', 3: 'overcast',
            45: 'fog', 48: 'depositing_rime_fog',
            51: 'light_drizzle', 53: 'moderate_drizzle', 55: 'dense_drizzle',
            56: 'light_freezing_drizzle', 57: 'dense_freezing_drizzle',
            61: 'slight_rain', 63: 'moderate_rain', 65: 'heavy_rain',
            66: 'light_freezing_rain', 67: 'heavy_freezing_rain',
            71: 'slight_snow', 73: 'moderate_snow', 75: 'heavy_snow', 77: 'snow_grains',
            80: 'slight_showers', 81: 'moderate_showers', 82: 'violent_showers',
            85: 'slight_snow_showers', 86: 'heavy_snow_showers',
            95: 'thunderstorm', 96: 'thunderstorm_slight_hail', 99: 'thunderstorm_heavy_hail'
        };
        const key = map[code] || 'unknown';
        return t(key);
    }

    // --- Weather Effects ---
    function generateWeatherEffects(weatherCode) {
        const weatherCard = document.getElementById('weather-card');
        const effectsContainer = document.getElementById('weather-effects');
        
        // æ¸…ç©ºä¹‹å‰çš„æ•ˆæœ
        weatherCard.className = 'weather-card';
        effectsContainer.innerHTML = '';
        
        // æ ¹æ®å¤©æ°”ä»£ç æ·»åŠ å¯¹åº”æ•ˆæœ
        if ([0, 1].includes(weatherCode)) {
            // æ™´å¤©æˆ–ä¸»è¦æ™´æœ—
            weatherCard.classList.add('weather-clear');
            effectsContainer.innerHTML = '<div class="weather-sun"></div>';
        } else if ([2, 3].includes(weatherCode)) {
            // éƒ¨åˆ†å¤šäº‘æˆ–é˜´å¤©
            effectsContainer.innerHTML = `
                <div class="weather-cloud weather-cloud-1"></div>
                <div class="weather-cloud weather-cloud-2"></div>
            `;
        } else if ([45, 48].includes(weatherCode)) {
            // æœ‰é›¾
            weatherCard.classList.add('weather-fog');
        } else if ([51, 53, 55, 56, 57, 61, 63, 65, 66, 67].includes(weatherCode)) {
            // ä¸‹é›¨
            effectsContainer.innerHTML = '<div class="weather-rain" id="rain-container"></div>';
            createRaindrops();
        } else if ([71, 73, 75, 77, 80, 81, 82, 85, 86].includes(weatherCode)) {
            // ä¸‹é›ª
            effectsContainer.innerHTML = '<div id="snow-container"></div>';
            createSnowflakes();
        } else if ([95, 96, 99].includes(weatherCode)) {
            // é›·æš´
            effectsContainer.innerHTML = '<div class="weather-lightning" id="lightning-container"></div>';
            createLightningFlashes();
        }
    }

    function createRaindrops() {
        const rainContainer = document.getElementById('rain-container');
        if (!rainContainer) return;
        
        for (let i = 0; i < 30; i++) {
            const raindrop = document.createElement('div');
            raindrop.className = 'raindrop';
            raindrop.style.left = Math.random() * 100 + '%';
            raindrop.style.animationDelay = Math.random() * 0.6 + 's';
            raindrop.style.animationDuration = (0.5 + Math.random() * 0.2) + 's';
            rainContainer.appendChild(raindrop);
        }
    }

    function createSnowflakes() {
        const snowContainer = document.getElementById('snow-container');
        if (!snowContainer) return;
        
        for (let i = 0; i < 20; i++) {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.style.left = Math.random() * 100 + '%';
            snowflake.style.animationDelay = Math.random() * 3 + 's';
            snowflake.style.animationDuration = (2 + Math.random() * 2) + 's';
            snowContainer.appendChild(snowflake);
        }
    }

    function createLightningFlashes() {
        const lightningContainer = document.getElementById('lightning-container');
        if (!lightningContainer) return;
        
        // åˆ›å»ºé—ªç”µæ•ˆæœ
        const createFlash = () => {
            const flash = document.createElement('div');
            flash.className = 'lightning-flash';
            flash.style.animationDelay = '0s';
            lightningContainer.appendChild(flash);
            
            // åŠ¨ç”»å®Œæˆåç§»é™¤
            setTimeout(() => {
                flash.remove();
            }, 300);
        };
        
        // éšæœºé—ªç”µ
        setInterval(() => {
            if (Math.random() > 0.7) {
                createFlash();
            }
        }, 2000);
    }

    // --- Fetch weather data (unified implementation) ---
     async function fetchWeatherData(lat, lon, cityName) {
         try {
             const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
             const data = await res.json();
             document.getElementById('weather-city').innerText = cityName;
             if (data && data.current_weather) {
                const weatherCode = data.current_weather.weathercode;
                lastWeatherCode = weatherCode;
                document.getElementById('temp-display').innerText = Math.round(data.current_weather.temperature) + "Â°C";
                const desc = weatherCodeToDesc(weatherCode);
                document.getElementById('weather-desc').innerText = desc;
                // ç”Ÿæˆå¤©æ°”æ•ˆæœ
                generateWeatherEffects(weatherCode);
             } else {
                 document.getElementById('temp-display').innerText = "--Â°C";
                 document.getElementById('weather-desc').innerText = t('weather_unavailable');
             }
         } catch (e) {
             document.getElementById('weather-desc').innerText = t('weather_error');
         }
     }

    // --- Blogger & Quote ---
    async function updateQuote() {
        try {
            const res = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('https://zenquotes.io/api/random'));
            const data = await res.json();
            const q = JSON.parse(data.contents)[0];
            const authorName = q.a ? q.a.trim() : 'Unknown';
            document.getElementById('quote-text').innerText = `"${q.q}"`;
            document.getElementById('quote-author').innerText = `â€” ${authorName}`;
            // set portrait based on author (DiceBear avatar); updates when quote changes
            const portraitEl = document.getElementById('quote-portrait');
            // ensure onerror is set before assigning src so fallback works
            portraitEl.onerror = function() {
                this.onerror = null;
                this.src = 'https://avatars.dicebear.com/api/identicon/Unknown.png?scale=80&background=%23ffffff';
            };
            // use PNG variant and add timestamp to bypass caching
            portraitEl.src = `https://avatars.dicebear.com/api/avataaars/${encodeURIComponent(authorName)}.png?scale=80&background=%23ffffff&v=${Date.now()}`;
        } catch(e) {
            document.getElementById('quote-text').innerText = '"' + t('unable_load_quote') + '"';
            document.getElementById('quote-author').innerText = 'â€” ' + t('unknown');
            console.warn('Quote fetch error:', e);
        }
     }
     async function fetchBloggerPosts() {
         try {
             const res = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent('https://justinkwo.blogspot.com/feeds/posts/default?alt=json&max-results=3')}`);
             const data = await res.json();
             const parsed = JSON.parse(data.contents);
             const entries = Array.isArray(parsed.feed.entry) ? parsed.feed.entry : [parsed.feed.entry];
             if (!entries || entries.length === 0) {
                 document.getElementById('blogger-content').innerHTML = '<div style="font-size: 13px; color: #888;">' + t('no_posts') + '</div>';
                 return;
             }
             document.getElementById('blogger-content').innerHTML = '<ul style="list-style:none; padding:0; margin:0;">' + entries.map(e => {
                 const linkObj = e.link.find(l => l.rel === 'alternate');
                 const href = linkObj ? linkObj.href : '#';
                 return `<li style="margin-bottom:8px"><a href="${href}" target="_blank" class="site-link" style="padding:0; font-size:14px">â€¢ ${e.title.$t}</a></li>`;
             }).join('') + '</ul>';
         } catch(e) {
             document.getElementById('blogger-content').innerHTML = '<div style="font-size: 13px; color: #888;">' + t('unable_load_posts') + '</div>';
             console.warn('Blogger fetch error:', e);
         }
      }

      // --- Init ---
      document.addEventListener('DOMContentLoaded', () => {
          // åˆå§‹åŒ–è¯­è¨€é€‰æ‹©å™¨
          const languageSelector = document.getElementById('language-selector');
          languageSelector.value = currentLanguage;
          languageSelector.addEventListener('change', (e) => {
              changeLanguage(e.target.value);
          });

          // åˆå§‹åŒ–UIæ–‡æœ¬
          updateUIText();

          const localeForDate = dateLocaleMap[currentLanguage] || 'en-US';
            // initial UI update
            updateUIText();
            initWeather(); updateQuote(); fetchBloggerPosts();
            // start realtime clock
            startClock();
            // fetch holidays using ip geolocation
            try { fetchCountryAndHolidays(); } catch(e) { console.warn('Holiday fetch skipped', e); }
      });
    // --- Sticky Navigation (improved, uses placeholder and recalculation on resize) ---
    const navContainer = document.querySelector('.quick-nav-container');
    let navOriginalTop = 0;
    let navPlaceholder = null;

    function updateNavOriginalTop() {
        // compute the Y offset of the nav container relative to the document
        const rect = navContainer.getBoundingClientRect();
        navOriginalTop = window.scrollY + rect.top;
    }

    function enableSticky() {
        if (navContainer.classList.contains('sticky')) return;
        // insert placeholder to avoid layout jump
        navPlaceholder = document.createElement('div');
        navPlaceholder.style.height = navContainer.offsetHeight + 'px';
        navContainer.parentNode.insertBefore(navPlaceholder, navContainer);
        navContainer.classList.add('sticky');
        document.body.classList.add('nav-sticky');
    }

    function disableSticky() {
        if (!navContainer.classList.contains('sticky')) return;
        navContainer.classList.remove('sticky');
        document.body.classList.remove('nav-sticky');
        if (navPlaceholder && navPlaceholder.parentNode) {
            navPlaceholder.parentNode.removeChild(navPlaceholder);
            navPlaceholder = null;
        }
    }

    // handle scroll
    window.addEventListener('scroll', () => {
        const y = window.scrollY;
        if (y >= navOriginalTop) enableSticky(); else disableSticky();
    });
    // recalc on load & resize (debounced)
    window.addEventListener('load', updateNavOriginalTop);
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            // remove sticky for measurement, then recalc
            const wasSticky = navContainer.classList.contains('sticky');
            if (wasSticky) disableSticky();
            updateNavOriginalTop();
            if (wasSticky && window.scrollY >= navOriginalTop) enableSticky();
        }, 120);
    });
    // initial calculation
    updateNavOriginalTop();

    // --- Games modal logic ---
    (function(){
        const overlay = document.getElementById('gameModalOverlay');
        const iframe = document.getElementById('gameIframe');
        const titleEl = document.getElementById('gameModalTitle');
        const fallback = document.getElementById('gameFallback');
        const openLink = document.getElementById('gameOpenLink');
        const closeBtn = document.getElementById('gameModalClose');

        // open game (skip tiles that use internal implementations, e.g. data-internal="chess")
        document.querySelectorAll('.game-tile').forEach(tile => {
            if (tile.hasAttribute('data-internal')) return; // internal tile handled elsewhere
            tile.addEventListener('click', () => {
                const src = tile.getAttribute('data-src') || 'about:blank';
                const titleKey = tile.getAttribute('aria-label').toLowerCase().replace(/\s+/g, '_');
                const title = t(titleKey) || tile.getAttribute('data-title') || 'Game';
                titleEl.innerText = title;
                overlay.style.display = 'flex';
                fallback.style.display = 'none';
                iframe.src = src;
                openLink.href = src;
                // if src is about:blank show fallback message
                if (src === 'about:blank') {
                    iframe.style.display = 'none';
                    fallback.style.display = 'flex';
                } else {
                    iframe.style.display = 'block';
                    // if iframe fails to load embedding, show fallback after timer
                    let handled = false;
                    const onLoad = () => { handled = true; iframe.onload = null; };
                    iframe.onload = onLoad;
                    setTimeout(() => {
                        if (!handled) { iframe.style.display = 'none'; fallback.style.display = 'flex'; }
                    }, 2500);
                }
            });
        });
        
        // close game modal
        function closeGameModal() {
            overlay.style.display = 'none';
            iframe.src = 'about:blank';
            fallback.style.display = 'none';
        }
        closeBtn.addEventListener('click', closeGameModal);
        overlay.addEventListener('click', (e) => { if (e.target === overlay) closeGameModal(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && overlay.style.display === 'flex') closeGameModal(); });
    })();

    // chessboard internal game click handling (load libs then init)
    (function(){
        let chessGame = null;
        let chessBoard = null;
        const overlay = document.getElementById('chessModalOverlay');
        const chessClose = document.getElementById('chessModalClose');
        const chessNew = document.getElementById('chessNew');
        const chessUndo = document.getElementById('chessUndo');
        const chessStatus = document.getElementById('chessStatus');
        const chessOpenExternal = document.getElementById('chessOpenExternal');

        function loadScript(src) {
            return new Promise((res, rej) => {
                const s = document.createElement('script');
                s.src = src; s.onload = res; s.onerror = rej;
                document.head.appendChild(s);
            });
        }

        // init after libs loaded
        async function ensureLibs() {
            if (window.Chess && window.Chessboard) return;
            try {
                if (!window.Chess) await loadScript('https://cdn.jsdelivr.net/npm/chess.js@1.0.0/chess.min.js');
                if (!window.Chessboard) await loadScript('https://cdn.jsdelivr.net/npm/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js');
            } catch (e) { console.warn('Failed to load chess libs', e); }
        }

        function updateStatus() {
            if (!chessGame) return;
            if (chessGame.in_checkmate()) chessStatus.textContent = t('checkmate');
            else if (chessGame.in_draw()) chessStatus.textContent = t('draw');
            else {
                const turn = chessGame.turn() === 'w' ? t('white') : t('black');
                chessStatus.textContent = turn + (chessGame.in_check() ? ' â€” ' + t('check') : '');
            }
        }

        function initChessBoard() {
            chessGame = new Chess();
            const cfg = {
                draggable: true,
                position: chessGame.fen(),
                onDragStart: function(source, piece) {
                    if (chessGame.game_over()) return false;
                    // only allow dragging pieces of the side to move
                    if ((chessGame.turn() === 'w' && piece.search(/^b/) !== -1) ||
                        (chessGame.turn() === 'b' && piece.search(/^w/) !== -1)) return false;
                },
                onDrop: function(source, target) {
                    const move = chessGame.move({ from: source, to: target, promotion: 'q' });
                    if (move === null) return 'snapback';
                    updateStatus();
                },
                onSnapEnd: function() {
                    chessBoard.position(chessGame.fen());
                },
                onMouseoutSquare: function(square, piece) {
                    chessBoard.removeMarker(square);
                },
                onHighlightSquare: function(square) {
                    const move = chessGame.move({ from: square, to: square, promotion: 'q' });
                    if (move === null) return;
                    chessBoard.addMarker(square, 'green');
                }
            };
            chessBoard = Chessboard('chessBoard', cfg);
            chessBoard.position('start');
            updateStatus();
        }

        // open chess modal
        document.querySelectorAll('.game-tile[data-internal="chess"]').forEach(tile => {
            tile.addEventListener('click', async () => {
                await ensureLibs();
                initChessBoard();
                const title = tile.getAttribute('data-title') || 'Game';
                document.getElementById('chessModalTitle').innerText = t('international_chess');
                document.getElementById('chessNew').textContent = t('new_game');
                document.getElementById('chessUndo').textContent = t('undo');
                document.getElementById('chessOpenExternal').textContent = t('open_external');
                document.getElementById('chessStatus').textContent = t('ready');
                overlay.style.display = 'flex';
            });
        });

        // close modal
         chessClose.addEventListener('click', () => {
             overlay.style.display = 'none';
             if (chessBoard) {
                 chessBoard.destroy();
                 chessBoard = null;
             }
             chessGame = null;
         });

        // close on overlay background click
        overlay.addEventListener('click', (e) => { 
            if (e.target === overlay) {
                overlay.style.display = 'none';
                if (chessBoard) {
                    chessBoard.destroy();
                    chessBoard = null;
                }
                chessGame = null;
            }
        });

        // close on ESC key
        document.addEventListener('keydown', (e) => { 
            if (e.key === 'Escape' && overlay.style.display === 'flex') {
                overlay.style.display = 'none';
                if (chessBoard) {
                    chessBoard.destroy();
                    chessBoard = null;
                }
                chessGame = null;
            }
        });

        // new game
        chessNew.addEventListener('click', () => {
            if (chessGame) {
                chessGame.reset();
                chessBoard.position('start');
                updateStatus();
            }
        });

        // undo move
        chessUndo.addEventListener('click', () => {
            if (chessGame && chessGame.history().length > 0) {
                chessGame.undo();
                chessBoard.position(chessGame.fen());
                updateStatus();
            }
        });

        // open external link
        chessOpenExternal.addEventListener('click', (e) => {
            const fen = chessGame ? chessGame.fen() : '';
            const url = `https://lichess.org/editor?fen=${fen}`;
            window.open(url, '_blank');
            e.preventDefault();
        });
    })();
</script>

</body>
</html>